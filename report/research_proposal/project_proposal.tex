\documentclass[12pt, a4paper]{article}

\usepackage[margin=1in, headheight=14.5pt]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{times}
\usepackage{ragged2e} 
\usepackage{csquotes} 
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{booktabs} 
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage[style=apa, backend=biber]{biblatex}

\addbibresource{proposal_bibliography.bib} 
\addbibresource{proposal_manual_bibliography.bib}

\usepackage{titlesec}

\titleformat{\section}{\normalfont\fontsize{12}{15}\bfseries}{\thesection. }{0em}{}
\titleformat{\subsection}{\normalfont\fontsize{12}{15}\itshape}{\thesubsection. }{0em}{}
\titleformat{\subsubsection}{\normalfont\fontsize{12}{15}\mdseries}{\thesubsubsection. }{0em}{}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{2ex plus 0.5ex minus .2ex}{1ex plus .2ex}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    citecolor=blue,
    urlcolor=blue,
    pdftitle={Extended Research Project Proposal},
    pdfauthor={Giedrius Mirklys},
}


\begin{document}

\title{\textbf{PROJECT DESCRIPTION} \\ \vspace{1.5em} \large Modeling Behavior-Relevant Latent Neural Dynamics to Decode Brain States and Motor Behavior in Parkinson’s Disease}
\author{Giedrius Mirklys \\
    \normalsize{Student Number: s1101773}}
\date{\today} % Or a specific date

\maketitle
\RaggedRight


\section{ABSTRACT}
Parkinson’s disease (PD) is a neurodegenerative disorder associated with motor dysfunction and pathological beta-band oscillations within cortico-basal ganglia circuits. Continuous deep brain stimulation (cDBS) is a well-established treatment, but its non-personalized application can result in adverse effects, prompting the development of adaptive DBS (aDBS). The advancement of aDBS depends on computational models capable of interpreting neural signals in real time to guide stimulation. The linear Preferential Subspace Identification (PSID) and nonlinear Dissociative Prioritized Analysis of Dynamics (DPAD) frameworks have demonstrated success in modeling non-pathological behavior-relevant neural dynamics in animal studies. However, their effectiveness in decoding complex, pathological neural signals in human neurological disorders has not yet been established. This master’s thesis evaluates the utility of these frameworks for decoding brain states and behavior in PD. The primary objectives are to assess model performance in three tasks: $(1)$ cross-modal prediction of electrocorticography (ECoG) from local field potential (LFP) signals, $(2)$ classification of discrete DBS ON/OFF brain states, and $(3)$ continuous decoding of motor behavior. By applying these modeling frameworks to simultaneous LFP and ECoG neural recordings, this research aims to develop a method for extracting behaviorally relevant dynamics from multiplexed neural signals characteristic of PD. The results may provide insights into the neural dynamics of PD and the derivation of biomarkers for closed-loop stimulation from latent model states.

\section{PROJECT DESCRIPTION}


According to the \textcite{who_parkinson_2023}, rates of Parkinson's disease (PD) have doubled over the last 25 years, affecting an estimated 8.5 million people in 2019. The disease manifests in movement-related symptoms, including slowness of movement, rigidity, and tremor, alongside cognitive decline, with origins in both genetic and environmental factors \parencite{ben-shlomoEpidemiologyParkinsonsDisease2024}. The primary pathology in PD is the degeneration of dopaminergic neurons in the substantia nigra, which disrupts the cortico-basal ganglia-thalamo-cortical loop. Neurophysiologically, \textcite{tinkhauserBetaBurstDynamics2017} described that prolonged beta-band oscillations ($13-30$ Hz) are a key indicator of this disruption, and their power correlates with motor symptom severity. This contrasts with healthy brains, where beta oscillations are typically transient bursts.

Therapeutic strategies aim to correct these network-level disturbances by reducing beta frequency synchrony within the basal ganglia and between it and the motor cortex \parencite{tinkhauserBetaBurstDynamics2017, paulsCorticalBetaBurst2022}. While pharmacological treatments, such as Levodopa, can suppress these oscillations, Continuous Deep Brain Stimulation (cDBS) is an effective alternative for managing advanced symptoms. cDBS involves implanting electrodes in the subthalamic nucleus (STN) and is theorized to act as an \textit{informational lesion}, overriding the pathological beta rhythm \parencite{chikenMechanismDeepBrain2016, mcintyreNetworkPerspectivesMechanisms2010}. However, continuous stimulation can cause side effects due to current spreading to non-targeted neural structures \parencite{zarzyckiStimulationinducedSideEffects2020}.

This limitation has motivated the development of adaptive DBS (aDBS), a closed-loop approach delivering stimulation only when needed. The success of aDBS depends on identifying reliable biomarkers from complex neural data in real-time. While beta oscillations are a primary candidate, their causal role is debated, and patient-specific biomarkers may be more effective \parencite{swannGammaOscillationsHyperkinetic2016, wuComputationalModelsAdvance2024}. The rationale for aDBS is that targeting personalized neuromarkers could lead to more efficient stimulation with fewer side effects \parencite{littleAdaptiveDeepBrain2013}. Computational models are thus essential for mapping neural signals to clinical states, identifying robust neuromarkers, and evaluating control strategies in silico, as tuning controllers on patients is impractical.

\textcite{saniModelingBehaviorallyRelevant2021} described two standard approaches to neural modeling: Neural Dynamic Modeling (NDM), which is behavior-agnostic, and Representational Modeling (RM), which is agnostic to intrinsic neural dynamics. Neither is designed to isolate the dynamics shared between neural activity and behavior. Since brain areas receive multiplex information from numerous afferent neural sites \parencite{wuMixedSelectivitySubthalamic2025}, it is more effective to capture behavior-relevant latent neural dynamics for a more nuanced understanding of brain disorders and the development of treatment or rehabilitation methods.

This thesis will evaluate two data-driven modeling frameworks for decoding latent neural dynamics in PD: the linear Preferential Subspace Identification (PSID) model \parencite{saniModelingBehaviorallyRelevant2021} and the nonlinear Dissociative Prioritized Analysis of Dynamics (DPAD) model \parencite{saniDissociativePrioritizedModeling2024}. While both have been successful in animal studies, their application to pathological human signals remains unexplored. The project will evaluate these models on three tasks: $(1)$ predicting ECoG from LFP signals, $(2)$ classifying DBS ON/OFF brain states, and $(3)$ decoding motor behavior. Baseline models, including NDM and linear DPAD, will be used to distinguish between the efficacy of analytical and numerical optimization approaches, and to evaluate the role of linear versus nonlinear representations. Application of these modeling frameworks to LFP and ECoG data from PD patients is expected to extract behaviorally relevant dynamics from multiplexed signals. The findings are anticipated to provide insights into the neural mechanisms underlying PD and support the development of neuromarkers for closed-loop therapies.

\subsection{Data and Preprocessing}
This project uses data from the Dareplane project \parencite{doldLFPECoGData2024}, which includes LFP, ECoG, and EEG recordings from PD patients. The primary dataset comprises simultaneous 16-channel LFP and 4-channel ECoG recordings from 4 participants across 9 sessions, with hand kinematics captured to derive tracing speed (calculated from hand position samples). The data, originally sampled at 22 kHz, contains blocks for DBS ON/OFF states. A preprocessing pipeline will be applied to each modality, including downsampling (LFP/ECoG to 1000 Hz, EEG to 250 Hz) and a 50 Hz notch filter.

\begin{itemize}

    \item \textbf{LFP Processing:} DBS artifacts in ON-state recordings will be removed using template subtraction \parencite{qianMethodRemovalDeep2017,hammerArtifactCharacterizationMultipurpose2022}. The data will then be band-pass filtered (3-250 Hz) and re-referenced using a Common Average Reference (CAR).

    \item \textbf{ECoG Processing:} ECoG data will be band-pass filtered (3-250 Hz), re-referenced using CAR, and if high frequency stimulation artifacts are present, they will be removed using the same subtraction method.

    \item \textbf{EEG Processing:} EEG data will be preprocessed using frequency filtering (3-100 Hz), re-referencing, and ICA for artifact removal. Source Power Comodulation (SPoC) will be used to derive spatial filters.

\end{itemize}

The PSID and DPAD models will be trained on one-second epochs of the minimally preprocessed data. Model generalization will be assessed using leave-one-session-out cross-validation, stratified by participant. Within each training fold, data will be split into training (80\%) and validation (20\%) sets.

\subsection{Exploratory Data Analysis}

Exploratory data analysis will be performed to characterize the dataset's statistical properties. First, the relationship between neural signals (LFP, ECoG, EEG) and behavior (tracing speed) will be quantified using Pearson and Spearman correlations. For direct comparisons between signals with different bandwidths (e.g., EEG vs. ECoG), all the signals will be cut off up to 100 Hz. Second, to establish a baseline for the task 1, the correlation between LFP and ECoG will be analyzed. Third, Power Spectral Density (PSD) estimates for DBS ON vs. OFF conditions will be compared to support the task 2, and the PSD differences will be assessed statistically using a Wilcoxon signed-rank test. Finally, after the task 3, model residuals will be tested for a lack of autocorrelation using a Ljung-Box test \parencite{ljungMeasureLackFit1978}. This will validate that the models have captured the underlying dynamics if the residuals resemble white noise or there is no dependence on the past residual values.

\subsection{Preferential Subspace Identification (PSID)}

\textcite{saniModelingBehaviorallyRelevant2021} developed Preferential Subspace Identification (PSID) to target shared neural-behavioral dynamics. By training to predict future behavioral outputs from past neural activity, the model is forced to discover and represent the behaviorally relevant neural dynamics. To formalize this, PSID adopts a linear time-invariant (LTI) state-space model structure:

$$
\begin{cases}
\mathbf{x}_{k+1} = A \mathbf{x}_k + \mathbf{w}_k \\
\mathbf{y}_k = C_y \mathbf{x}_k + \mathbf{v}_k \\
\mathbf{z}_k = C_z \mathbf{x}_k + \epsilon_k
\end{cases}
$$

Here, $k$ is the time index; $\mathbf{x}_k \in \mathbb{R}^{n_x}$ is the unobserved, low-dimensional latent state (with $n_x$ dimensions) that evolves according to the state transition matrix $A$; $\mathbf{y}_k \in \mathbb{R}^{n_y}$ is the observed neural activity from $n_y$ channels, generated from the latent state via the observation matrix $C_y$; and $\mathbf{z}_k \in \mathbb{R}^{n_z}$ is the observed behavioral variable from $n_z$ dimensions, generated via the observation matrix $C_z$. The terms $\mathbf{w}_k$, $\mathbf{v}_k$, and $\epsilon_k$ represent state, neural observation, and behavioral residuals (noise), respectively. The total latent state $\mathbf{x}_k$ is composed of a prioritized, behaviorally relevant subspace $\mathbf{x}_k^{(1)}$ (with dimension $n_1$) and a non-prioritized subspace $\mathbf{x}_k^{(2)}$ (with dimension $n_2$).

PSID uses a non-iterative, closed-form procedure to learn model parameters. It projects future behavior ($\mathbf{Z}_f$) onto past neural activity ($\mathbf{Y}_p$) to isolate the predictable component of behavior:
$$\hat{\mathbf{Z}}_f = \mathbf{Z}_f \mathbf{Y}_p^T (\mathbf{Y}_p \mathbf{Y}_p^T)^{-1} \mathbf{Y}_p.$$
This projection is then decomposed using Singular Value Decomposition (SVD) to identify the observability matrix and the behaviorally relevant latent states. System matrices ($A$, $C_y$, $C_z$) are then estimated via linear regression. Finally, a Kalman filter computes the optimal latent state sequence $\mathbf{x}_k$, yielding an interpretable linear model of behaviorally relevant latent neural dynamics.


\subsection{Dissociative Prioritized Analysis of Dynamics (DPAD)}

To account for the brain's nonlinear computations, \textcite{saniDissociativePrioritizedModeling2024} proposed the Dissociative Prioritized Analysis of Dynamics (DPAD) framework. DPAD not only \textit{prioritizes} behaviorally relevant dynamics but also \textit{dissociates} them from irrelevant dynamics. It partitions the latent state $\mathbf{x}_k$ into a prioritized component $\mathbf{x}_k^{(1)}$ for predicting behavior and a non-prioritized component $\mathbf{x}_k^{(2)}$ for modeling remaining neural variance.

This dissociation is enforced through a four-step training process, where behavior $\hat{\mathbf{z}}_k$ is predicted only from the prioritized state, while neural activity $\hat{\mathbf{y}}_k$ is reconstructed from both:

$$
    \begin{cases}
        \mathbf{x}_{k+1} = \mathbf{A}'(\mathbf{x}_k) + \mathbf{K}'(\mathbf{y}_k)           \\
        \hat{\mathbf{y}}_k = C_y^{(1)}(\mathbf{x}_k^{(1)}) + C_y^{(2)}(\mathbf{x}_k^{(2)}) \\
        \hat{\mathbf{z}}_k = C_z^{(1)}(\mathbf{x}_k^{(1)})
    \end{cases}
$$

Here, $\mathbf{A}'$, $\mathbf{K}'$, and the observation mappings are nonlinear functions (e.g., MLPs). DPAD's training process first forces the prioritized state $\mathbf{x}_k^{(1)} \in \mathbb{R}^{n_1}$ to learn behavior-predictive dynamics. These weights are then frozen, and the non-prioritized state $\mathbf{x}_k^{(2)} \in \mathbb{R}^{n_2}$ is trained to explain the remaining neural variance. An optional final step fine-tunes all parameters. This yields a nonlinear model with an interpretable, dissociated latent representation suitable for exploring PD dynamics.


\subsection{Baseline Model Configurations}
To benchmark the performance of the primary models, two key baselines will be implemented.

\subsubsection{Neural Dynamic Modeling (NDM) Baseline}

The NDM baseline, which models neural dynamics agnostic to behavior, will be configured by setting the dimension of the behaviorally-prioritized subspace to zero. This forces the models to learn latent states that best predict future neural activity from past neural activity. By setting $n_1 = 0$ in PSID, the model bypasses behavior-driven projections, solely projecting future neural activity $Y_f$ onto past neural activity $Y_p$. In DPAD, setting $n_1 = 0$ bypasses behavior-based optimization steps, making the objective learning a latent state that predicts future neural activity.

\subsubsection{Linear DPAD Baseline}

A linear version of DPAD will serve as a counterpart to the analytical PSID. This is achieved by setting the neural input, state recursion, and observation mappings to be linear (i.e., zero hidden layers in the network), creating a linear state-space model trained via numerical optimization.

\subsection{RQ1: Cross-Modal Neural Prediction}

\begin{quote}

    \textbf{Research Question 1:} To what extent can the models predict future ECoG activity from past ECoG activity? Furthermore, to what extent can PSID and DPAD predict cortical ECoG activity from subcortical LFP recordings, and how well do these predictions generalize across recording sessions for a given patient?

\end{quote}

This research question addresses the feasibility of neural signal translation. The initial analysis will assess whether ECoG signals can be predicted one step ahead of time and then predict ECoG from LFP input, with a focus on DBS-OFF state data. Prediction accuracy will be measured using the Coefficient of Determination ($R^2$). To further analyze the learned relationships, Canonical Correlation Analysis (CCA) and Deep CCA (DCCA) will quantify the strength of linear and nonlinear coupling between LFP and ECoG signals, as well as between past and predicted ECoG.

\subsection{RQ2: Brain State Classification}

\begin{quote}

    \textbf{Research Question 2:} How accurately can PSID and DPAD classify discrete brain states (DBS ON vs. OFF) from LFP/ECoG signals?

\end{quote}

This task assesses the models' ability to identify distinct, clinically relevant brain states. The methodology uses the learned latent states as features for a logistic regression classifier to perform a binary classification of the DBS ON/OFF condition. Performance will be assessed using metrics, including the Area Under the ROC Curve (AUC), the F1-Score, and Balanced Accuracy. To interpret the learned representations, the latent state trajectories will be visualized using t-SNE to confirm class separability. To quantitatively compare the representations, Representational Similarity Analysis (RSA) will be performed. Representational Dissimilarity Matrices (RDMs) will be constructed from both the neural data and the latent states of the models. Their correlation will be calculated to assess the alignment between the model's internal geometry and the underlying neural geometry.


\subsection{RQ3: Continuous Motor Behavior Decoding}
\begin{quote}
    \textbf{Research Question 3:} How effectively can PSID and DPAD decode continuous motor behavior (tracing speed) from LFP activity, and what do their respective latent dynamics reveal about the linear vs. nonlinear neural control of movement?
\end{quote}

This research question targets the primary challenge in developing future adaptive DBS systems. The main analysis will involve training models to decode tracing speed directly from LFP signals. As a secondary analysis, a two-stage decoding approach will be investigated to evaluate the "virtual sensor" concept. First, the models from RQ1 will be used to generate predicted ECoG signals from the LFP data. Second, these predicted ECoG signals will serve as input for decoding the tracing speed. This will quantify how much behaviorally relevant information is preserved or possibly enriched in the cross-modally predicted cortical signals.

Decoding performance for both approaches will be evaluated using Pearson's and Spearman’s correlation coefficients. The relationship between model dynamics and behavior will be further quantified using Canonical Correlation Analysis (CCA) and Deep CCA (DCCA) to measure the correlation between latent state trajectories and tracing speed data. For the DPAD model, the contributions of its prioritized ($\mathbf{x}^{(1)}$) and non-prioritized ($\mathbf{x}^{(2)}$) subspaces will be directly compared. Representational Similarity Analysis (RSA) will also be used to compare the geometric structure of the latent spaces to the structure of the behavior itself.

\vspace{1em}
\noindent\textbf{Word Count:} 1886
\newpage
\section{SCHEDULE}
\begin{table}[h!]
    \centering
    \label{tab:schedule}
    \resizebox{0.95\textwidth}{!}{
        \begin{tabularx}{\textwidth}{>{\RaggedRight}X l l >{\RaggedRight}X}
            \textbf{Task}                                        & \textbf{Start Date} & \textbf{End Date} & \textbf{Key Goals / Milestones}                                                                                             \\
            \midrule
            Finalizing project proposal                          & 2025-09-01          & 2025-09-07        &                                                                                                                             \\

            Data Analysis \& pipeline scaffolding                & 2025-09-08          & 2025-09-28        & Pipeline for DBS/ECoG preprocessing                                                                                         \\

            Building full training pipeline                      & 2025-09-29          & 2025-11-02        & Pipeline running a full experiment (load, preprocess, train, evaluate) from a YAML configs.                                 \\

            Drafting Background \& Methodology                   & 2025-09-29          & 2025-11-02        &                                                                                                                             \\

            Baselines model training                             & 2025-11-03          & 2025-11-16        & Generate first-pass results with PSID and a basic DPAD configuration on all RQs.                                            \\

            Main Training \& Hyperparameter Tuning               & 2025-11-10          & 2025-12-21        & Running all the experiments with different configurations.                                                                  \\

            In-depth Analysis of Initial Results                 & 2025-11-17          & 2025-12-07        & Analyze baseline results. Develop scripts for latent space analysis, create initial figures.                                \\


            Refining Background \& Methods Drafts                & 2025-12-08          & 2025-12-21        & Incorporate new insights from initial results into the report drafts.                                                       \\

            Christmas Break                                      & 2025-12-22          & 2026-01-04        & Rest and light work on refining drafts as needed.                                                                           \\

            Getting full results                                 & 2026-01-05          & 2026-01-18        & Finalize all model training and hyperparameter tuning. Get all the results and ensure they are reproducible and documented. \\

            Drafting Results Section                             & 2026-01-05          & 2026-01-25        & Write the main narrative for the Results section using all finalized model outputs.                                         \\

            Drafting Discussion Section                          & 2026-01-19          & 2026-02-08        & Connect results back to the background and discuss implications.                                                            \\

            Planning Thesis Presentation                         & 2026-01-26          & 2026-02-08        &                                                                                                                             \\

            Drafting Introduction \& Abstract                    & 2026-02-09          & 2026-02-15        &                                                                                                                             \\

            Consolidating Full Report                            & 2026-02-15          & 2026-02-22        & Polish all sections, figures, and references into a single, cohesive document.                                              \\

            Finalizing Thesis Presentation/Slides                & 2026-02-23          & 2026-03-01        & Finalize slides and practice the presentation.                                                                              \\

            Final Revisions, Unplanned Delays \& Submission Prep & 2026-03-02          & 2026-03-30        &                                                                                                                             \\
        \end{tabularx}
    }
\end{table}

\newpage

\section{SCIENTIFIC, SOCIETAL AND/OR TECHNOLOGICAL RELEVANCE}

This research project extends directly to adaptive Deep Brain Stimulation (aDBS) for Parkinson's disease. The objective is to transition from continuous stimulation to intelligent, on-demand therapy. By validating computational models that can decode motor performance and classify clinical states in real-time, this work provides an analytical foundation for future closed-loop systems. Such systems have the potential to enhance therapeutic efficacy and reduce side effects. The methodological framework presented here has broader implications beyond Parkinson's disease and motor control. The capacity to dissociate and model behaviorally relevant neural dynamics is essential for addressing various neurological and psychiatric conditions, including epilepsy, depression, and obsessive-compulsive disorder. These principles could be potentially applied to decode seizure precursors, affective states, or cognitive fluctuations, thereby facilitating the development of adaptive neuromodulation therapies across various clinical applications.
\section{REFERENCES}
\printbibliography[heading=none]


\end{document}