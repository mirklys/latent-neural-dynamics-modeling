\documentclass[12pt, a4paper]{article}

\usepackage[margin=1in, headheight=14.5pt]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{times}
\usepackage{ragged2e} 
\usepackage{csquotes} 
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{booktabs} 
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage[style=apa, backend=biber]{biblatex}

\addbibresource{proposal_bibliography.bib} 
\addbibresource{proposal_manual_bibliography.bib}

\usepackage{titlesec}

\titleformat{\section}{\normalfont\fontsize{12}{15}\bfseries}{\thesection. }{0em}{}
\titleformat{\subsection}{\normalfont\fontsize{12}{15}\itshape}{\thesubsection. }{0em}{}
\titleformat{\subsubsection}{\normalfont\fontsize{12}{15}\mdseries}{\thesubsubsection. }{0em}{}
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{2ex plus 0.5ex minus .2ex}{1ex plus .2ex}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    citecolor=blue,
    urlcolor=blue,
    pdftitle={Extended Research Project Proposal},
    pdfauthor={Giedrius Mirklys},
}


\begin{document}

\title{\textbf{PROJECT DESCRIPTION} \\ \vspace{1.5em} \large Modeling Latent Neural Dynamics to Decode Brain States and Motor Behavior in Parkinson’s Disease}
\author{Giedrius Mirklys \\
    \normalsize{Student Number: s1101773}}
\date{\today} % Or a specific date

\maketitle
\RaggedRight


\section{ABSTRACT}
Parkinson’s disease (PD) is a neurological disorder where motor symptoms are linked to pathological beta-band oscillations within cortico-basal ganglia circuits. While continuous Deep Brain Stimulation (DBS) is an effective treatment, its non-adaptive nature can lead to side effects, motivating a shift toward adaptive DBS (aDBS). The development of such therapies hinges on models that can interpret neural signals in real-time to guide stimulation. The linear Preferential Subspace Identification (PSID) and nonlinear Dissociative Prioritized Analysis of Dynamics (DPAD) frameworks have been successful in modeling non-pathological neural dynamics with animal data. However, their applicability for decoding complex, pathological signals in human neurological disorders remains unexplored. This thesis will investigate the utility of these models for decoding brain states and behavior in PD. The primary objectives are to characterize model performance across three tasks: $(1)$ cross-modal prediction of ECoG from LFP signals, $(2)$ classification of discrete DBS ON/OFF brain states, and $(3)$ continuous decoding of motor behavior. By applying these frameworks to simultaneous LFP and ECoG data, this master's thesis research project aims to develop a model capable of extracting behaviorally relevant dynamics from multiplexed neural signals characteristic of PD. The findings may offer insights into the neural dynamics of the disease, informing how biomarkers for closed-loop stimulation could be derived from latent model states.

\section{PROJECT DESCRIPTION}
% max 2000 words
% Use \parencite{key} for parenthetical citations, e.g., (Author, 2023).
% Use \textcite{key} for narrative citations, e.g., Author (2023) demonstrates.

According to the \textcite{who_parkinson_2023}, rates of Parkinson's disease (PD) have doubled over the last 25 years, affecting an estimated 8.5 million people in 2019. The disease manifests in motor symptoms like slowness of movement, rigidity, and tremor, alongside cognitive decline, with origins in genetic and environmental factors \parencite{ben-shlomoEpidemiologyParkinsonsDisease2024}. The primary pathology in PD is the loss of dopaminergic neurons in the substantia nigra, disrupting the cortico-basal ganglia-thalamo-cortical loop. Neurophysiologically, prolonged beta-band oscillations ($13-30$ Hz) are a key indicator of this disruption, and their power correlates with motor symptom severity. This contrasts with healthy brains, where beta oscillations are typically transient bursts \parencite{tinkhauserBetaBurstDynamics2017}.

Therapeutic strategies aim to correct these network-level disturbances by reducing beta frequency synchrony within the basal ganglia and between it and the motor cortex \parencite{tinkhauserBetaBurstDynamics2017, paulsCorticalBetaBurst2022}. While pharmacological treatments like Levodopa can suppress these oscillations, Deep Brain Stimulation (DBS) is an effective alternative for advanced symptoms. DBS involves implanting electrodes in the subthalamic nucleus (STN) and is theorized to act as an \textit{informational lesion}, overriding the pathological beta rhythm \parencite{chikenMechanismDeepBrain2016, mcintyreNetworkPerspectivesMechanisms2010}. However, continuous stimulation can cause side effects due to current spreading to non-targeted neural structures \parencite{zarzyckiStimulationinducedSideEffects2020}.

This limitation has motivated the development of adaptive DBS (aDBS), a closed-loop approach delivering stimulation only when needed. The success of aDBS depends on identifying reliable biomarkers from complex neural data in real-time. While beta oscillations are a primary candidate, their causal role is debated, and patient-specific biomarkers may be more effective \parencite{swannGammaOscillationsHyperkinetic2016, wuComputationalModelsAdvance2024}. The rationale for aDBS is that targeting personalized neuromarkers could lead to more efficient stimulation with fewer side effects \parencite{littleAdaptiveDeepBrain2013}. Computational models are thus essential for mapping neural signals to clinical states to identify robust neuromarkers and to evaluate control strategies in silico, as tuning controllers on patients is impractical.

\textcite{saniModelingBehaviorallyRelevant2021} described two standard approaches to neural modeling: Neural Dynamic Modeling (NDM), which is behavior-agnostic, and Representational Modeling (RM), which is agnostic to intrinsic neural dynamics. Neither is designed to isolate the dynamics shared between neural activity and behavior. The challenge lies in separating these behaviorally relevant dynamics from the vast background of other neural signals, a critical task given that motor-related areas like the STN multiplex information for numerous variables \parencite{wuMixedSelectivitySubthalamic2025}.

This thesis will evaluate two data-driven modeling frameworks for decoding latent neural dynamics in PD: the linear Preferential Subspace Identification (PSID) model \parencite{saniModelingBehaviorallyRelevant2021} and the nonlinear Dissociative Prioritized Analysis of Dynamics (DPAD) model \parencite{saniDissociativePrioritizedModeling2024}. While both have succeeded in animal studies, their application to pathological human signals is unexplored.

The project will benchmark these models across three research questions: (1) cross-modal prediction of cortical ECoG from subcortical LFP signals, (2) classification of discrete DBS ON/OFF brain states, and (3) continuous decoding of motor behavior (tracing speed). Baseline configurations, including NDM and a linear DPAD variant, will be used to compare analytical vs. numerical optimization, standard vs. specialized modeling, and linear vs. nonlinear representations.

By applying these frameworks to LFP and ECoG data from PD patients, this research aims to extract behaviorally relevant dynamics from multiplexed signals. The findings may offer insights into PD's neural mechanisms and inform the development of biomarkers for closed-loop therapies.

\subsection{Data and Preprocessing}
This project uses data from the Dareplane project \parencite{doldLFPECoGData2024}, which includes LFP, ECoG, and EEG recordings from PD patients. The primary dataset consists of simultaneous 16-channel LFP and 4-channel ECoG from 4 participants across 9 sessions, with hand kinematics captured to derive tracing speed. The data, originally sampled at 22 kHz, contains blocks for DBS ON/OFF states. A preprocessing pipeline will be applied to each modality, including downsampling (LFP/ECoG to 1000 Hz, EEG to 100 Hz) and a 50 Hz notch filter.

\begin{itemize}
    \item \textbf{LFP Processing:} DBS artifacts in ON-state recordings will be removed using template subtraction \parencite{qianMethodRemovalDeep2017,hammerArtifactCharacterizationMultipurpose2022}. Data will then be band-pass filtered (3-250 Hz) and re-referenced with a Common Average Reference (CAR).

    \item \textbf{ECoG Processing:} ECoG data will be band-pass filtered (3-250 Hz) and re-referenced using CAR.

    \item \textbf{EEG Processing:} EEG data will be preprocessed following established pipelines, including filtering, re-referencing, and ICA for artifact removal. Source Power Comodulation (SPoC) will be used to derive task-specific spatial filters.
\end{itemize}

The PSID and DPAD models will be trained on one-second epochs of the preprocessed time-series data. Model generalization will be assessed using leave-one-session-out cross-validation, stratified by participant. Within each training fold, data will be split into training (80\%) and validation (20\%) sets.


\subsection{Exploratory Data Analysis}
Exploratory data analysis will be performed to characterize the dataset's statistical properties. First, the relationship between neural signals (LFP, ECoG) and behavior (tracing speed) will be quantified using Pearson and Spearman correlations. Second, to establish a baseline for RQ1, the correlation between LFP and ECoG will be analyzed. Third, Power Spectral Density (PSD) estimates for DBS ON vs. OFF conditions will be compared to provide a baseline for RQ2. Finally, model residuals will be checked for whiteness to validate that the models have captured the underlying dynamics.

\subsection{Preferential Subspace Identification (PSID)}
\textcite{saniModelingBehaviorallyRelevant2021} developed Preferential Subspace Identification (PSID) to target shared neural-behavioral dynamics. By training a model to predict future behavior from past neural activity, PSID learns behaviorally relevant dynamics. It uses a linear time-invariant (LTI) state-space model for tractability and interpretability:
\[
    \begin{cases}
        \mathbf{x}_{k+1} = A \mathbf{x}_k + \mathbf{w}_k \\
        \mathbf{y}_k = C_y \mathbf{x}_k + \mathbf{v}_k   \\
        \mathbf{z}_k = C_z \mathbf{x}_k + \boldsymbol{\epsilon}_k
    \end{cases}
\]
Here, $\mathbf{x}_k$ is the latent state, $\mathbf{y}_k$ is the observed neural activity, and $\mathbf{z}_k$ is the observed behavior. The terms $\mathbf{w}_k$, $\mathbf{v}_k$, and $\boldsymbol{\epsilon}_k$ are residual noise.

PSID uses a non-iterative, closed-form procedure to learn model parameters. It projects future behavior onto past neural activity to isolate the predictable behavioral component. Singular Value Decomposition (SVD) of this projection identifies the observability matrix and the behaviorally relevant latent states. System matrices ($A$, $C_y$, $C_z$) are then estimated via linear regression. Finally, a Kalman filter computes the optimal latent state sequence $\mathbf{x}_k$, yielding an interpretable linear model of behaviorally relevant neural dynamics.

\subsection{Dissociative Prioritized Analysis of Dynamics (DPAD)}
To account for the brain's nonlinear computations, \textcite{saniDissociativePrioritizedModeling2024} proposed the Dissociative Prioritized Analysis of Dynamics (DPAD) framework. DPAD not only prioritizes behaviorally relevant dynamics but also dissociates them from irrelevant dynamics. It partitions the latent state $\mathbf{x}_k$ into a prioritized component $\mathbf{x}_k^{(1)}$ for predicting behavior and a non-prioritized component $\mathbf{x}_k^{(2)}$ for modeling remaining neural variance.
This dissociation is enforced through a four-step training process, where behavior $\hat{\mathbf{z}}_k$ is predicted only from the prioritized state, while neural activity $\hat{\mathbf{y}}_k$ is reconstructed from both:
$$
    \begin{cases}
        \mathbf{x}_{k+1} = \mathbf{A}'(\mathbf{x}_k) + \mathbf{K}'(\mathbf{y}_k)           \\
        \hat{\mathbf{y}}_k = C_y^{(1)}(\mathbf{x}_k^{(1)}) + C_y^{(2)}(\mathbf{x}_k^{(2)}) \\
        \hat{\mathbf{z}}_k = C_z^{(1)}(\mathbf{x}_k^{(1)})
    \end{cases}
$$
Here, $\mathbf{A}'$, $\mathbf{K}'$, and the observation mappings are nonlinear functions (e.g., MLPs). DPAD's training process first forces the prioritized state $\mathbf{x}_k^{(1)}$ to learn behavior-predictive dynamics. These weights are then frozen, and the non-prioritized state $\mathbf{x}_k^{(2)}$ is trained to explain the remaining neural variance. An optional final step fine-tunes all parameters. This yields a nonlinear model with an interpretable, dissociated latent representation suitable for exploring PD dynamics.


\subsection{Baseline Model Configurations}
To benchmark the performance of the primary models, two key baselines will be implemented.

\subsubsection{Neural Dynamic Modeling (NDM) Baseline}
The NDM baseline models neural dynamics agnostic to behavior and is configured by setting the behaviorally-prioritized subspace dimension to zero ($n_1 = 0$).
    \begin{itemize}
        \item For \textbf{PSID}, this means states are identified by projecting future \textit{neural activity} onto past neural activity (standard Subspace Identification).
        \item For \textbf{DPAD}, this bypasses behavior-based optimization steps, making the objective learning a latent state that predicts future neural activity.
    \end{itemize}

\subsubsection{Linear DPAD Baseline}
A linear version of DPAD will serve as a counterpart to the analytical PSID. This is achieved by setting the neural input, state recursion, and observation mappings to be linear (i.e., zero hidden layers in the RNN), creating a linear state-space model trained via numerical optimization.

\subsection{RQ1: Cross-Modal Neural Prediction}
\begin{quote}
    \textbf{Research Question 1:} To what extent can the models predict future ECoG activity from past ECoG activity? Building on this, to what extent can the models predict cortical ECoG activity from subcortical LFP recordings, and how well do these predictions generalize across recording sessions for a given patient?
\end{quote}

This question will investigate the feasibility of neural signal translation. The initial configuration consists of self-prediction, whether it is possible to predict ECoG signals a head of time. The models will be trained to predict ECoG using only LFP input, focusing on data from the DBS-OFF state. Prediction accuracy will be quantified using the Coefficient of Determination ($R^2$). For a deeper analysis of the learned relationship, Canonical Correlation Analysis (CCA) and Deep CCA (DCCA) will be employed to quantify the strength of the linear and nonlinear coupling, respectively, between the LFP and ECoG signals, and between past ECoG and predicted ECoG.

\subsection{RQ2: Brain State Classification}
\begin{quote}
    \textbf{Research Question 2:} How accurately can PSID and DPAD classify discrete brain states (DBS ON vs. OFF) from LFP/ECoG signals?
\end{quote}

This task assesses the models' ability to identify distinct, clinically relevant brain states. The methodology involves using the learned latent states as features for a logistic regression classifier to perform a binary classification of the DBS ON/OFF condition. Performance will be assessed using metrics, including the Area Under the ROC Curve (AUC), the F1-Score, and Balanced Accuracy. To interpret the learned representations, the latent state trajectories will be visualized using t-SNE to confirm class separability. To quantitatively compare the learned representations, Representational Similarity Analysis (RSA) will be performed. Representational Dissimilarity Matrices (RDMs) will be constructed from both the neural data and the models' latent states, and their correlation will be calculated to assess the alignment between the model's internal geometry and the underlying neural geometry.
\subsection{RQ3: Continuous Motor Behavior Decoding}
\begin{quote}
    \textbf{Research Question 3:} How effectively can PSID and DPAD decode continuous motor behavior (tracing speed) from LFP activity, and what do their respective latent dynamics reveal about the linear vs. nonlinear neural control of movement?
\end{quote}

This final question addresses the core challenge for developing future adaptive DBS systems. The models will be trained to decode a continuous behavioral variable, tracing speed, from LFP signals. Decoding performance will be evaluated using Pearson's correlation coefficient. The quantitative link between the models' internal dynamics and the behavior will be established using CCA and DCCA to measure the correlation between the latent state trajectories and the continuous tracing speed data. For the DPAD model, the distinct contributions of its prioritized ($\mathbf{x}^{(1)}$) and non-prioritized ($\mathbf{x}^{(2)}$) subspaces will be explicitly compared. Furthermore, RSA will be used to compare the geometric structure of the latent spaces to the structure of the behavior itself.


\vspace{1em}
\noindent\textbf{Word Count:} 2031
\newpage
\section{SCHEDULE}
\begin{table}[h!]
    \centering
    \label{tab:schedule}
    \resizebox{0.95\textwidth}{!}{
        \begin{tabularx}{\textwidth}{>{\RaggedRight}X l l >{\RaggedRight}X}
            \textbf{Task}                                        & \textbf{Start Date} & \textbf{End Date} & \textbf{Key Goals / Milestones}                                                                                             \\
            \midrule
            Finalizing project proposal                          & 2025-09-01          & 2025-09-07        &                                                                                                                             \\

            Data Analysis \& pipeline scaffolding                & 2025-09-08          & 2025-09-28        & Pipeline for DBS/ECoG preprocessing                                                                                         \\

            Building full training pipeline                      & 2025-09-29          & 2025-11-02        & Pipeline running a full experiment (load, preprocess, train, evaluate) from a YAML configs.                                 \\

            Drafting Background \& Methodology                   & 2025-09-29          & 2025-11-02        &                                                                                                                             \\

            Baselines model training                             & 2025-11-03          & 2025-11-16        & Generate first-pass results with PSID and a basic DPAD configuration on all RQs.                                            \\

            Main Training \& Hyperparameter Tuning               & 2025-11-10          & 2025-12-21        & Running all the experiments with different configurations.                                                                  \\

            In-depth Analysis of Initial Results                 & 2025-11-17          & 2025-12-07        & Analyze baseline results. Develop scripts for latent space analysis, create initial figures.                                \\


            Refining Background \& Methods Drafts                & 2025-12-08          & 2025-12-21        & Incorporate new insights from initial results into the report drafts.                                                       \\

            Christmas Break                                      & 2025-12-22          & 2026-01-04        & Rest and light work on refining drafts as needed.                                                                           \\

            Getting full results                                 & 2026-01-05          & 2026-01-18        & Finalize all model training and hyperparameter tuning. Get all the results and ensure they are reproducible and documented. \\

            Drafting Results Section                             & 2026-01-05          & 2026-01-25        & Write the main narrative for the Results section using all finalized model outputs.                                         \\

            Drafting Discussion Section                          & 2026-01-19          & 2026-02-08        & Connect results back to the background and discuss implications.                                                            \\

            Planning Thesis Presentation                         & 2026-01-26          & 2026-02-08        &                                                                                                                             \\

            Drafting Introduction \& Abstract                    & 2026-02-09          & 2026-02-15        &                                                                                                                             \\

            Consolidating Full Report                            & 2026-02-15          & 2026-02-22        & Polish all sections, figures, and references into a single, cohesive document.                                              \\

            Finalizing Thesis Presentation/Slides                & 2026-02-23          & 2026-03-01        & Finalize slides and practice the presentation.                                                                              \\

            Final Revisions, Unplanned Delays \& Submission Prep & 2026-03-02          & 2026-03-30        &                                                                                                                             \\
        \end{tabularx}
    }
\end{table}

\newpage

\section{SCIENTIFIC, SOCIETAL AND/OR TECHNOLOGICAL RELEVANCE}
% TODO: Describe the broader context and relevance of your project.
% : (ABOUT 250 WORDS)
The clinical implications of this research extend directly to adaptive Deep Brain Stimulation (aDBS) for Parkinson's disease, aiming to transform the current standard of continuous stimulation into an intelligent, on-demand therapy. By validating computational models capable of decoding motor performance and classifying clinical states in real-time, .this work aims to provide an analytical foundation for future closed-loop systems that could significantly enhance therapeutic efficacy while mitigating side effects. Furthermore, the exploration of cross-modal prediction investigates the potential for creating "virtual sensors," which could leverage the rich information from cortical signals without the need for additional invasive surgeries. However, the broader implications of this methodological framework are not confined to Parkinson's disease or motor control. The ability to dissociate and model behaviorally-relevant neural dynamics is a fundamental tool applicable to a wide range of neurological and psychiatric conditions, including epilepsy, depression, and obsessive-compulsive disorder. The same principles could be used to decode seizure precursors, affective states, or cognitive fluctuations, paving the way for adaptive neuromodulation therapies across the clinical spectrum.

\section{REFERENCES}
\printbibliography[heading=none]


\end{document}